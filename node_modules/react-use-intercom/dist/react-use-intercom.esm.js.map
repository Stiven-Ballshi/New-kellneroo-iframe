{"version":3,"file":"react-use-intercom.esm.js","sources":["../src/logger.ts","../src/utils.ts","../src/api.ts","../src/context.ts","../src/initialize.ts","../src/mappers.ts","../src/provider.tsx","../src/useIntercom.ts"],"sourcesContent":["import { LogLevel } from './types';\n\n/**\n * Logs messages in the console with a corresponding urgency\n *\n * @param level the urgency of the message\n * @param message the message to log in the console\n */\nexport const log = (level: LogLevel, message: string) => {\n  if (__DEV__) {\n    const packageName = '[react-use-intercom]';\n\n    switch (level) {\n      case 'info':\n        console.log(`${packageName} ${message}`);\n        break;\n      case 'warn':\n        console.warn(`${packageName} ${message}`);\n        break;\n      case 'error':\n        console.error(`${packageName} ${message}`);\n        break;\n      default:\n        console.log(`${packageName} ${message}`);\n    }\n  }\n};\n","export const isSSR = typeof window === 'undefined';\n\n/**\n * Removes object entries where the value equals to `undefined`\n *\n * @param obj\n */\nexport const removeUndefined = (obj: any) => {\n  Object.keys(obj).forEach(key => {\n    if (obj[key] && typeof obj[key] === 'object') removeUndefined(obj[key]);\n    else if (obj[key] === undefined) delete obj[key];\n  });\n  return obj;\n};\n","import * as logger from './logger';\nimport { IntercomMethod } from './types';\nimport { isSSR } from './utils';\n\n/**\n * Safely exposes `window.Intercom` and passes the arguments to the instance\n *\n * @param method method passed to the `window.Intercom` instance\n * @param args arguments passed to the `window.Intercom` instance\n *\n * @see {@link https://developers.intercom.com/installing-intercom/docs/intercom-javascript}\n */\nconst IntercomAPI = (method: IntercomMethod, ...args: Array<any>) => {\n  if (!isSSR && window.Intercom) {\n    return window.Intercom.apply(null, [method, ...args]);\n  } else {\n    logger.log('error', `${method} Intercom instance is not initalized yet`);\n  }\n};\n\nexport default IntercomAPI;\n","import * as React from 'react';\n\nimport { IntercomContextValues } from './types';\n\nconst IntercomContext = React.createContext<IntercomContextValues | undefined>(\n  undefined,\n);\n\nexport default IntercomContext;\n","// @ts-nocheck\n/**\n * Snippet to initialize the Intercom instance\n *\n * @param appId - Intercom app id\n * @param [timeout=0] - Amount of milliseconds that the initialization should be delayed, defaults to 0\n *\n * @see {@link https://developers.intercom.com/installing-intercom/docs/basic-javascript}\n */\nconst initialize = (appId: string, timeout = 0) => {\n  var w = window;\n  var ic = w.Intercom;\n  if (typeof ic === 'function') {\n    ic('reattach_activator');\n    ic('update', w.intercomSettings);\n  } else {\n    var d = document;\n    var i = function() {\n      i.c(arguments);\n    };\n    i.q = [];\n    i.c = function(args) {\n      i.q.push(args);\n    };\n    w.Intercom = i;\n    var l = function() {\n      setTimeout(function() {\n        var s = d.createElement('script');\n        s.type = 'text/javascript';\n        s.async = true;\n        s.src = 'https://widget.intercom.io/widget/' + appId;\n        var x = d.getElementsByTagName('script')[0];\n        x.parentNode.insertBefore(s, x);\n      }, timeout);\n    };\n    if (document.readyState === 'complete') {\n      l();\n    } else if (w.attachEvent) {\n      w.attachEvent('onload', l);\n    } else {\n      w.addEventListener('load', l, false);\n    }\n  }\n};\n\nexport default initialize;\n","import {\n  DataAttributes,\n  DataAttributesAvatar,\n  DataAttributesCompany,\n  IntercomProps,\n  MessengerAttributes,\n  RawDataAttributes,\n  RawDataAttributesAvatar,\n  RawDataAttributesCompany,\n  RawIntercomProps,\n  RawMessengerAttributes,\n} from './types';\nimport { removeUndefined } from './utils';\n\nexport const mapMessengerAttributesToRawMessengerAttributes = (\n  attributes: MessengerAttributes,\n): RawMessengerAttributes => ({\n  custom_launcher_selector: attributes.customLauncherSelector,\n  alignment: attributes.alignment,\n  vertical_padding: attributes.verticalPadding,\n  horizontal_padding: attributes.horizontalPadding,\n  hide_default_launcher: attributes.hideDefaultLauncher,\n  session_duration: attributes.sessionDuration,\n  action_color: attributes.actionColor,\n  background_color: attributes.backgroundColor,\n});\n\nconst mapDataAttributesCompanyToRawDataAttributesCompany = (\n  attributes: DataAttributesCompany,\n): RawDataAttributesCompany => ({\n  company_id: attributes.companyId,\n  name: attributes.name,\n  created_at: attributes.createdAt,\n  plan: attributes.plan,\n  monthly_spend: attributes.monthlySpend,\n  user_count: attributes.userCount,\n  size: attributes.size,\n  website: attributes.website,\n  industry: attributes.industry,\n  ...attributes.customAttributes,\n});\n\nconst mapDataAttributesAvatarToRawDataAttributesAvatar = (\n  attributes: DataAttributesAvatar,\n): RawDataAttributesAvatar => ({\n  type: attributes.type,\n  image_url: attributes.imageUrl,\n});\n\nexport const mapDataAttributesToRawDataAttributes = (\n  attributes: DataAttributes,\n): RawDataAttributes => ({\n  email: attributes.email,\n  user_id: attributes.userId,\n  created_at: attributes.createdAt,\n  name: attributes.name,\n  phone: attributes.phone,\n  last_request_at: attributes.lastRequestAt,\n  unsubscribed_from_emails: attributes.unsubscribedFromEmails,\n  language_override: attributes.languageOverride,\n  utm_campaign: attributes.utmCampaign,\n  utm_content: attributes.utmContent,\n  utm_medium: attributes.utmMedium,\n  utm_source: attributes.utmSource,\n  utm_term: attributes.utmTerm,\n  avatar:\n    attributes.avatar &&\n    mapDataAttributesAvatarToRawDataAttributesAvatar(attributes.avatar),\n  user_hash: attributes.userHash,\n  company:\n    attributes.company &&\n    mapDataAttributesCompanyToRawDataAttributesCompany(attributes.company),\n  companies: attributes.companies?.map(\n    mapDataAttributesCompanyToRawDataAttributesCompany,\n  ),\n  ...attributes.customAttributes,\n});\n\nexport const mapIntercomPropsToRawIntercomProps = (\n  props: IntercomProps,\n): RawIntercomProps => {\n  return removeUndefined({\n    ...mapMessengerAttributesToRawMessengerAttributes(props),\n    ...mapDataAttributesToRawDataAttributes(props),\n  });\n};\n","import * as React from 'react';\n\nimport IntercomAPI from './api';\nimport IntercomContext from './context';\nimport initialize from './initialize';\nimport * as logger from './logger';\nimport { mapIntercomPropsToRawIntercomProps } from './mappers';\nimport {\n  IntercomContextValues,\n  IntercomProps,\n  IntercomProviderProps,\n  RawIntercomBootProps,\n} from './types';\nimport { isSSR } from './utils';\n\nexport const IntercomProvider: React.FC<React.PropsWithChildren<\n  IntercomProviderProps\n>> = ({\n  appId,\n  autoBoot = false,\n  autoBootProps,\n  children,\n  onHide,\n  onShow,\n  onUnreadCountChange,\n  shouldInitialize = !isSSR,\n  apiBase,\n  initializeDelay,\n  ...rest\n}) => {\n  const isBooted = React.useRef(false);\n  const isInitialized = React.useRef(false);\n\n  if (__DEV__) {\n    // Allow data-x attributes, see https://github.com/devrnt/react-use-intercom/issues/478\n    const invalidPropKeys = Object.keys(rest).filter(\n      key => !key.startsWith('data-'),\n    );\n\n    if (invalidPropKeys.length > 0) {\n      logger.log(\n        'warn',\n        [\n          'some invalid props were passed to IntercomProvider. ',\n          `Please check following props: ${invalidPropKeys.join(', ')}.`,\n        ].join(''),\n      );\n    }\n  }\n\n  const boot = React.useCallback(\n    (props?: IntercomProps) => {\n      if (!window.Intercom && !shouldInitialize) {\n        logger.log(\n          'warn',\n          'Intercom instance is not initialized because `shouldInitialize` is set to `false` in `IntercomProvider`',\n        );\n        return;\n      }\n\n      if (isBooted.current) {\n        return;\n      }\n\n      const metaData: RawIntercomBootProps = {\n        app_id: appId,\n        ...(apiBase && { api_base: apiBase }),\n        ...(props && mapIntercomPropsToRawIntercomProps(props)),\n      };\n\n      window.intercomSettings = metaData;\n      IntercomAPI('boot', metaData);\n      isBooted.current = true;\n    },\n    [apiBase, appId, shouldInitialize],\n  );\n\n  const [isOpen, setIsOpen] = React.useState(false);\n\n  const onHideWrapper = React.useCallback(() => {\n    setIsOpen(false);\n    if (onHide) onHide();\n  }, [onHide, setIsOpen]);\n\n  const onShowWrapper = React.useCallback(() => {\n    setIsOpen(true);\n    if (onShow) onShow();\n  }, [onShow, setIsOpen]);\n\n  if (!isSSR && shouldInitialize && !isInitialized.current) {\n    initialize(appId, initializeDelay);\n\n    // attach listeners\n    IntercomAPI('onHide', onHideWrapper);\n    IntercomAPI('onShow', onShowWrapper);\n    if (onUnreadCountChange)\n      IntercomAPI('onUnreadCountChange', onUnreadCountChange);\n\n    if (autoBoot) {\n      boot(autoBootProps);\n    }\n\n    isInitialized.current = true;\n  }\n\n  const ensureIntercom = React.useCallback(\n    (\n      functionName: string = 'A function',\n      callback: (() => void) | (() => string),\n    ) => {\n      if (!window.Intercom && !shouldInitialize) {\n        logger.log(\n          'warn',\n          'Intercom instance is not initialized because `shouldInitialize` is set to `false` in `IntercomProvider`',\n        );\n        return;\n      }\n      if (!isBooted.current) {\n        logger.log(\n          'warn',\n          [\n            `'${functionName}' was called but Intercom has not booted yet. `,\n            `Please call 'boot' before calling '${functionName}' or `,\n            `set 'autoBoot' to true in the IntercomProvider.`,\n          ].join(''),\n        );\n        return;\n      }\n      return callback();\n    },\n    [shouldInitialize],\n  );\n\n  const shutdown = React.useCallback(() => {\n    if (!isBooted.current) return;\n\n    IntercomAPI('shutdown');\n    delete window.intercomSettings;\n    isBooted.current = false;\n  }, []);\n\n  const hardShutdown = React.useCallback(() => {\n    if (!isBooted.current) return;\n\n    IntercomAPI('shutdown');\n    delete window.Intercom;\n    delete window.intercomSettings;\n    isBooted.current = false;\n  }, []);\n\n  const refresh = React.useCallback(() => {\n    ensureIntercom('update', () => {\n      const last_request_at = Math.floor(new Date().getTime() / 1000);\n      IntercomAPI('update', { last_request_at });\n    });\n  }, [ensureIntercom]);\n\n  const update = React.useCallback(\n    (props?: IntercomProps) => {\n      ensureIntercom('update', () => {\n        if (!props) {\n          refresh();\n          return;\n        }\n        const rawProps = mapIntercomPropsToRawIntercomProps(props);\n        window.intercomSettings = { ...window.intercomSettings, ...rawProps };\n        IntercomAPI('update', rawProps);\n      });\n    },\n    [ensureIntercom, refresh],\n  );\n\n  const hide = React.useCallback(() => {\n    ensureIntercom('hide', () => {\n      IntercomAPI('hide');\n    });\n  }, [ensureIntercom]);\n\n  const show = React.useCallback(() => {\n    ensureIntercom('show', () => IntercomAPI('show'));\n  }, [ensureIntercom]);\n\n  const showMessages = React.useCallback(() => {\n    ensureIntercom('showMessages', () => {\n      IntercomAPI('showMessages');\n    });\n  }, [ensureIntercom]);\n\n  const showNewMessage = React.useCallback(\n    (message?: string) => {\n      ensureIntercom('showNewMessage', () => {\n        if (!message) {\n          IntercomAPI('showNewMessage');\n        } else {\n          IntercomAPI('showNewMessage', message);\n        }\n      });\n    },\n    [ensureIntercom],\n  );\n\n  const getVisitorId = React.useCallback(() => {\n    return ensureIntercom('getVisitorId', () => {\n      return IntercomAPI('getVisitorId');\n    }) as string;\n  }, [ensureIntercom]);\n\n  const startTour = React.useCallback(\n    (tourId: number) => {\n      ensureIntercom('startTour', () => {\n        IntercomAPI('startTour', tourId);\n      });\n    },\n    [ensureIntercom],\n  );\n\n  const trackEvent = React.useCallback(\n    (event: string, metaData?: object) => {\n      ensureIntercom('trackEvent', () => {\n        if (metaData) {\n          IntercomAPI('trackEvent', event, metaData);\n        } else {\n          IntercomAPI('trackEvent', event);\n        }\n      });\n    },\n    [ensureIntercom],\n  );\n\n  const showArticle = React.useCallback(\n    (articleId: number) =>\n      ensureIntercom('showArticle', () => {\n        IntercomAPI('showArticle', articleId);\n      }),\n    [ensureIntercom],\n  );\n\n  const providerValue = React.useMemo<IntercomContextValues>(() => {\n    return {\n      boot,\n      shutdown,\n      hardShutdown,\n      update,\n      hide,\n      show,\n      isOpen,\n      showMessages,\n      showNewMessage,\n      getVisitorId,\n      startTour,\n      trackEvent,\n      showArticle,\n    };\n  }, [\n    boot,\n    shutdown,\n    hardShutdown,\n    update,\n    hide,\n    show,\n    isOpen,\n    showMessages,\n    showNewMessage,\n    getVisitorId,\n    startTour,\n    trackEvent,\n    showArticle,\n  ]);\n\n  return (\n    <IntercomContext.Provider value={providerValue}>\n      {children}\n    </IntercomContext.Provider>\n  );\n};\n\nexport const useIntercomContext = () => {\n  const context = React.useContext(IntercomContext);\n\n  if (__DEV__) {\n    if (context === undefined) {\n      throw new Error('`useIntercom` must be used within `IntercomProvider`.');\n    }\n  }\n\n  return context as IntercomContextValues;\n};\n","import { useIntercomContext } from './provider';\n\nexport const useIntercom = () => {\n  return useIntercomContext();\n};\n"],"names":["log","level","message","packageName","console","warn","error","isSSR","window","removeUndefined","obj","Object","keys","forEach","key","undefined","IntercomAPI","method","Intercom","args","apply","logger","IntercomContext","React","initialize","appId","timeout","w","ic","intercomSettings","d","document","i","c","arguments","q","push","l","setTimeout","s","createElement","type","async","src","x","getElementsByTagName","parentNode","insertBefore","readyState","attachEvent","addEventListener","mapMessengerAttributesToRawMessengerAttributes","attributes","custom_launcher_selector","customLauncherSelector","alignment","vertical_padding","verticalPadding","horizontal_padding","horizontalPadding","hide_default_launcher","hideDefaultLauncher","session_duration","sessionDuration","action_color","actionColor","background_color","backgroundColor","mapDataAttributesCompanyToRawDataAttributesCompany","company_id","companyId","name","created_at","createdAt","plan","monthly_spend","monthlySpend","user_count","userCount","size","website","industry","customAttributes","mapDataAttributesAvatarToRawDataAttributesAvatar","image_url","imageUrl","mapDataAttributesToRawDataAttributes","email","user_id","userId","phone","last_request_at","lastRequestAt","unsubscribed_from_emails","unsubscribedFromEmails","language_override","languageOverride","utm_campaign","utmCampaign","utm_content","utmContent","utm_medium","utmMedium","utm_source","utmSource","utm_term","utmTerm","avatar","user_hash","userHash","company","companies","map","mapIntercomPropsToRawIntercomProps","props","IntercomProvider","autoBoot","autoBootProps","children","onHide","onShow","onUnreadCountChange","shouldInitialize","apiBase","initializeDelay","rest","isBooted","isInitialized","invalidPropKeys","filter","startsWith","length","join","boot","current","metaData","app_id","api_base","isOpen","setIsOpen","onHideWrapper","onShowWrapper","ensureIntercom","functionName","callback","shutdown","hardShutdown","refresh","Math","floor","Date","getTime","update","rawProps","hide","show","showMessages","showNewMessage","getVisitorId","startTour","tourId","trackEvent","event","showArticle","articleId","providerValue","Provider","value","useIntercomContext","context","Error","useIntercom"],"mappings":"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"}